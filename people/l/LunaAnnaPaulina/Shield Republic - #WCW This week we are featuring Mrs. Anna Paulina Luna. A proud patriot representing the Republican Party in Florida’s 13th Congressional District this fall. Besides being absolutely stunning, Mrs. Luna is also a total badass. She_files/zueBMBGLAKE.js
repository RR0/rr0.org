;/*FB_PKG_DELIM*/

__d("AbstractCommentLiveTypingXHRController",["destroyOnUnload","err"],(function(a,b,c,d,e,f){"use strict";var g={START:"start",STOP:"stop"},h=10*1e3;a=function(){function a(a,c,d,e){e===void 0&&(e=null),this.$5=a,this.$6=c,this.$7=d,this.$1=e,this.$2=!1,this.$3=0,this.$4=null,b("destroyOnUnload")(this.destroy.bind(this))}var c=a.prototype;c.destroy=function(){this.$1&&this.$1.destroy(),this.$1=null,this.$2=!1,this.$3=0,this.$4=null};c.bootloadPublisherModule=function(a){throw b("err")("bootloadPublisherModule not implemented, should be overridden by subclass")};c.$8=function(a){a=new a(this.$5,this.$6,this.$7);var b=Date.now(),c=this.$3;if(c&&c+h>=b){c=this.$4;c===g.START?a.handleStartEvent():c===g.STOP&&a.handleStopEvent()}this.$1=a};c.$9=function(){if(this.$2||!this.$5)return;this.$2=!0;this.bootloadPublisherModule(this.$8.bind(this))};c.attemptPublishStartEvent=function(){this.$4=g.START,this.$3=Date.now(),this.$1?this.$1.handleStartEvent():this.$2||this.$9()};c.attemptPublishStopEvent=function(){this.$4=g.STOP,this.$3=Date.now(),this.$1?this.$1.handleStopEvent():this.$2||this.$9()};return a}();f["default"]=a}),66);
__d("MComposerLiveTypingController",["AbstractCommentLiveTypingXHRController","Bootloader"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){return a.call(this,b,c,d)||this}var d=b.prototype;d.bootloadPublisherModule=function(a){c("Bootloader").loadModules(["MComposerLiveTypingPublisher"],a,"MComposerLiveTypingController")};d.attemptPublishStartEvent=function(){a.prototype.attemptPublishStartEvent.call(this)};d.attemptPublishStopEvent=function(){a.prototype.attemptPublishStopEvent.call(this)};return b}(c("AbstractCommentLiveTypingXHRController"));g["default"]=a}),98);
__d("MCommentComposer",["cx","CSS","ChannelClientID","ClientIDs","DOM","MComposerConfig","MComposerLiveTypingController","MLegacyDataStore","MMultiPhotoUploaderAttachmentState","MParent","MUFIInlineRepliesFunnelLogConfig","MViewport","Stratcom","StratcomManager","SubscriptionsHandler","TouchEventType","cancelAnimationFrame","debounceCore","ge","getActiveElement","requestAnimationFrame","setTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g,h){var i="m-ufi",j="feed-ufi",k="scroll-area",l="m-composer",m="m-photo-composer",n="m-inline-reply-composer",o="m-noninline-composer",p="textarea",q="privacy-selector",r="composer-submit",s="inline-reply",t="comment",u=100,v=!1;function w(){return!!c("MComposerConfig").PUBLISH_LIVE}function x(a){if(a.tagName==="FORM")return a;else return d("DOM").find(a,"form")}a=function(){function a(a,b){var e=this;this.destroy=function(){e.$7.release(),e.$19(),e.$15&&e.$15.destroy(),e.$15=null,e.$3&&e.$3.destroy(),e.$3=null};this.$26=function(a){a=a.getNode(l);if(a==null||!e.$44(a))return;var b=d("DOM").find(a,"*",p);e.$22(a);d("MLegacyDataStore").get(a).disable_auto_scroll||d("MViewport").scrollToNode(b)};this.$27=function(a){a=a.getNode(l);if(!a||!e.$44(a))return;c("CSS").removeClass(a,"composerClosed")};this.$24=function(a){var b=a.getNode(p);if(!(b instanceof HTMLInputElement||b instanceof HTMLTextAreaElement)||!e.$44(b))return;b=b.value;var c=e.$4;b!==c&&(b&&b.trim().length?e.$45():e.$39());e.$10(a);e.$4=b};this.$29=function(a){a=a.getData();var b=c("ge")(a.input_id);if(!b)return;b=d("MParent").bySigil(b,m);if(!b)return;b=d("DOM").find(b,"*",l);if(!e.$44(b))return;e.$12=a;e.$20(b);e.$22(b)};this.$30=function(a){a=a.getNode(l);if(!e.$44(a))return;e.$9||e.$22(a);e.$9=!1};this.$31=function(a){a=a.getNode(l);if(!e.$44(a))return;e.$20(a);e.$22(a);e.$23(a);e.$39()};this.$38=function(a){a=a.getTarget();if(!a||!e.$44(a))return;var b=d("DOM").scry(a,"input","mcomposer-client-id");b.length?b[0].setAttribute("value",d("ClientIDs").getNewClientID()):(b=d("DOM").create("input",{name:"client_id",sigil:"mcomposer-client-id",type:"hidden",value:d("ClientIDs").getNewClientID()}),a.appendChild(b));b=d("DOM").scry(a,"input","mcomposer-session-id");b.length||(b=d("DOM").create("input",{name:"session_id",sigil:"mcomposer-session-id",type:"hidden",value:d("ChannelClientID").getID()}),a.appendChild(b));w()&&e.$39();e.$46()};this.$43=function(a){a=a.getData().textInput;if(!e.$44(a))return;e.$46()};this.$32=function(a){var b=a.getNode(r);if(b==null)return;var c=d("MLegacyDataStore").get(b);if(b instanceof HTMLElement&&!c.onclickIsSet){a=a.getNode(l);if(!a||!e.$44(a))return;var f=d("DOM").find(a,"*",p);b.onclick=function(){f.blur()};c.onclickIsSet=!0}};this.$37=function(a){a=a.getData().element;if(!a||!d("DOM").contains(a,e.$1))return;a=d("DOM").find(e.$1,"*",l);var b=d("DOM").find(a,"*",p);a=d("DOM").scry(a,"*","m-mentions-root")[0];a=a&&d("MLegacyDataStore").get(a);a=a||{};a=a.mentionsInstance;var c=a&&a.getIgnoreFocusChange();a&&a.setIgnoreFocusChange(!0);b.blur();a&&a.setIgnoreFocusChange(c)};this.$33=function(a){a=a.getNode(l);if(!e.$44(a))return;a=d("DOM").find(a,"*",p);e.$15&&e.$15.logSubmit(a.value.length,e.$12[c("MMultiPhotoUploaderAttachmentState").UPLOADED],a.form);c("Stratcom").invoke("marauder-feedback-posted",null,{});e.$39()};this.$36=function(a){a=a.getNode(i);if(!a||!d("DOM").contains(a,e.$1))return;a=d("DOM").find(e.$1,"*",l);a=d("DOM").find(a,"*",p);a.focus()};this.$34=function(a){a=a.getData();a=a.target_id;e.$13&&a!==e.$2.target_id&&e.destroy()};this.$35=function(a){var b=c("getActiveElement")();if(b&&c("Stratcom").hasSigil(b,"textarea")&&e.$44(b)&&d("MParent").bySigil(b,m)){e.$9=!0;b.blur();e.$9=!1;e.$19();a=function(){e.$19();b.blur();var a=d("DOM").scry(e.$1,"*",l)[0];a&&e.$22(a)};var f=new(c("SubscriptionsHandler"))();f.addSubscriptions(c("Stratcom").listen("focus",null,a.bind(e)),c("Stratcom").listen(c("TouchEventType").START,null,a.bind(e)));e.$8=f}};this.$40=function(a){a=a.getData();a=a.input;a=e.$47(a);if(!a)return;e.$15&&e.$15.logInitPhoto()};this.$42=function(a){a=a.getData();var b=a.ufi;a=a.logKeys;if(!b||!a||!d("DOM").contains(b,e.$1))return;a.forEach(function(a){return e.$15&&e.$15.logRender(a)})};this.$41=function(a){a=a.getData();var b=a.commentNode;a=a.loggingInteractionKey;if(!b||!a)return;var f=c("Stratcom").hasSigil(b,s),g=null;if(e.$14&&f){var h=d("MParent").bySigil(b.parentNode,t);g=h&&d("DOM").scry(h,"*",n)[0]}else if(!f&&!e.$14){g=d("MParent").bySigil(b,m);if(!g&&e.$13){h=d("MParent").bySigil(b,j);g=d("DOM").scry(h,"*",o)[0]}}else return;f=g&&d("DOM").scry(g,"*",l)[0];if(!e.$44(f))return;e.$15&&e.$15.logRender(a)};this.$39=function(){if(!w())return;e.$48();e.$3&&e.$3.attemptPublishStopEvent()};this.$25=function(){e.$2.should_focus&&e.$2.input_id?c("setTimeoutAcrossTransitions")(function(){c("ge")(e.$2.input_id).focus(),e.$2.is_comments_permalink?d("MViewport").scrollToTop():c("ge")(e.$2.composer_id).scrollIntoView()},0):e.$2.should_anchor&&e.$2.composer_id?c("ge")(e.$2.composer_id).scrollIntoView():e.$2.should_anchor_reactions||d("MViewport").scrollToTop(),e.$16&&e.$16.remove()};this.$28=function(a){if(e.$2.send_with_softkey&&a.getSpecialKey()==="return"){a=a.getNode(l);var b=c("getActiveElement")();b&&b.blur();d("DOM").find(a,"*",r).click()}};this.$1=a;this.$2=b||{};this.$3=null;this.$4=null;this.$5=!!this.$2.toggle_submit;this.$10=this.$17();this.$12=c("MMultiPhotoUploaderAttachmentState").getDefaultState();this.$13=!!d("MParent").bySigil(a,j);this.$14=!!(this.$2.is_inline_reply&&d("MParent").bySigil(this.$1,n));this.$15=null;this.$2.log_comment&&c("MComposerConfig").MComposerLoggingController&&(this.$15=new(c("MComposerConfig").MComposerLoggingController)());this.$8=null;this.$9=!1;this.$7=new(c("SubscriptionsHandler"))();this.$18();c("Stratcom").invoke("marauder-fb-composer-init",null,{parent_fbid:"target_id"in this.$2?this.$2.target_id:-1})}var b=a.prototype;b.$19=function(){this.$8&&this.$8.release(),this.$8=null};b.$20=function(a){var b=this;if(!this.$5||!a)return;this.$6&&c("cancelAnimationFrame")(this.$6);this.$6=c("requestAnimationFrame")(function(){b.$6=null;var e=d("DOM").find(a,"*",r),f=b.$12[c("MMultiPhotoUploaderAttachmentState").SENDING]===0&&(!/^\s*$/.test(d("DOM").find(a,"*",p).value)||b.$12[c("MMultiPhotoUploaderAttachmentState").UPLOADED]>0);!f?e.setAttribute("disabled",!0):e.removeAttribute("disabled");c("CSS").conditionClass(e,"_56bt",!f);c("CSS").conditionClass(e,"_56bv",f);c("CSS").conditionClass(e,"_653w",f)})};b.$21=function(a){var b=this;a===this.$2.composer_id&&(this.$11=!0,c("setTimeout")(function(){b.$11=!1},u))};b.$22=function(a){var b=x(a);if(!a||!d("MLegacyDataStore").get(a).auto_collapse||!b||!d("MLegacyDataStore").get(b).expand_composer)return;b=d("DOM").find(a,"*",p);b=c("getActiveElement")()===b||!/^\s*$/.test(b.value)||this.$12[c("MMultiPhotoUploaderAttachmentState").UPLOADED]>0;if(!b&&this.$11)return;c("CSS").conditionClass(a,"composerClosed",!b)};b.$23=function(a){var b=d("DOM").find(a,"*","m-comment-conversation-guide-session-id");b&&(b.value="");b=d("DOM").find(a,"*","m-comment-conversation-guide-shown");b&&(b.value="none")};b.$18=function(){var a=this,b=w()?this.$24.bind(this):this.$10.bind(this);this.$2.isPageletified?this.$25():(this.$16=c("Stratcom").listen(["m:page:render:complete","m:schedulable:loaded"],null,this.$25.bind(this)),this.$7.addSubscriptions(this.$16));this.$7.addSubscriptions(c("Stratcom").listen("MCommentComposer:replyButtonClick",null,function(b){return a.$21(b.getData().composerID)}),c("Stratcom").listen("MCommentComposer:conversationGuideItemClick",null,function(b){return a.$21(b.getData().composerID)}),c("Stratcom").listen("focus",[l,p],this.$26.bind(this)),c("Stratcom").listen("focus",[l,q],this.$27.bind(this)),c("Stratcom").listen("keyup",[l,p],b),c("Stratcom").listen("keydown",[l,p],this.$28.bind(this)),c("Stratcom").listen("input",[l,p],b),c("Stratcom").listen("paste",[l,p],b),c("Stratcom").listen("MMultiPhotoUploader:attachments:change",null,this.$29.bind(this)),c("Stratcom").listen("blur",[l,p],this.$30.bind(this)),c("Stratcom").listen("reset",[l],this.$31.bind(this)),c("Stratcom").listen("touchend",[l,r],this.$32.bind(this)),c("Stratcom").listen("click",r,this.$33.bind(this)),c("Stratcom").listen("m:page:unload",null,this.destroy.bind(this)),c("Stratcom").listen("m:feed-ufi-flyout:reset",null,this.$34.bind(this)),this.$10);c("MComposerConfig").CAN_TOUCH_PHOTO_INPUT_WHILE_EXPANDED&&this.$7.addSubscriptions(c("Stratcom").listen("MMultiPhotoUploader:input:click",null,this.$35.bind(this)));this.$14||this.$7.addSubscriptions(c("Stratcom").listen("click","m-add-comment",this.$36.bind(this)));this.$13&&d("MParent").bySigil(this.$1,k)&&this.$7.addSubscriptions(c("Stratcom").listen("MScrollArea:scrollstart",null,this.$37.bind(this)));v||(v=!0,d("StratcomManager").enableDispatch(window,"reset"));this.$7.addSubscriptions(c("Stratcom").listen("submit",l,this.$38.bind(this)));w()&&this.$7.addSubscriptions(c("Stratcom").listen("m:feed-ufi:hide",null,this.$39.bind(this)));this.$15&&(this.$7.addSubscriptions(c("Stratcom").listen("MMultiPhotoUploader:input:change",null,this.$40.bind(this)),c("Stratcom").listen("m:ufi:iui:comment-added",null,this.$41.bind(this))),this.$14||this.$7.addSubscriptions(c("Stratcom").listen("m:ufi:live-comments:render",null,this.$42.bind(this))));this.$2.is_inline_reply&&c("MUFIInlineRepliesFunnelLogConfig").MUFIInlineReplyComposerFunnelLogger&&this.$7.addSubscriptions(c("Stratcom").listen("m:ufi:sticker-comment",null,this.$43.bind(this)))};b.$44=function(a){return!!a&&d("DOM").contains(this.$1,a)};b.$17=function(){var a=this;return c("debounceCore")(function(b){var d=b.getNode(p);if(!(d instanceof HTMLInputElement||d instanceof HTMLTextAreaElement)||!a.$44(d))return;c("Stratcom").invoke("marauder-feedback-input",null,{draft:d.value});a.$15&&a.$15.logInitText();a.$20(b.getNode(l))},250)};b.$46=function(){this.$2.is_inline_reply&&c("MUFIInlineRepliesFunnelLogConfig").MUFIInlineReplyComposerFunnelLogger&&c("MUFIInlineRepliesFunnelLogConfig").MUFIInlineReplyComposerFunnelLogger.logReplySubmitted(this.$2.target_id)};b.$47=function(a){if(!a)return null;a=d("MParent").bySigil(a,m);a=a&&d("DOM").scry(a,"*",l)[0];return a&&this.$44(a)?a:null};b.$48=function(){this.$2&&this.$2.target_id&&!this.$3&&w()&&(this.$3=new(c("MComposerLiveTypingController"))(this.$2.target_id,this.$2.parent_comment_id,this.$2.actor_id))};b.$45=function(){if(!w())return;this.$48();this.$3&&this.$3.attemptPublishStartEvent()};return a}();g["default"]=a}),98);
__d("MUFICommentViewportTracking",["MLegacyDataStore","MUFIConfig","MViewportTracking","MarauderLogger"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var e=b.prototype;e.getDataFromConfig=function(a){this.vpvLoggingEnabled=a.vpvLoggingEnabled};e.getStoryID=function(a){return d("MLegacyDataStore").get(a).token};e.getDataToLog=function(a){return this.getStoryID(a)};e.sendDataToLog=function(a){this.vpvLoggingEnabled&&d("MarauderLogger").log("comment_vpv",void 0,null,"comment",a)};e.getTimeout=function(){return c("MUFIConfig").vpvLoggingTimeout};return b}(c("MViewportTracking"));g["default"]=a}),98);
__d("CommentsTimeSpentTypedLogger",["Banzai","GeneratedLoggerUtils"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:CommentsTimeSpentLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:CommentsTimeSpentLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:CommentsTimeSpentLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setEndTime=function(a){this.$1.end_time=a;return this};c.setOrderingMode=function(a){this.$1.ordering_mode=a;return this};c.setPostFbid=function(a){this.$1.post_fbid=a;return this};c.setStartTime=function(a){this.$1.start_time=a;return this};c.setTimeSpentID=function(a){this.$1.time_spent_id=a;return this};c.setViewerHasInteracted=function(a){this.$1.viewer_has_interacted=a;return this};return a}();c={end_time:!0,ordering_mode:!0,post_fbid:!0,start_time:!0,time_spent_id:!0,viewer_has_interacted:!0};f["default"]=a}),66);
__d("MUFIStaticCommentViewportTracking",["CommentsTimeSpentTypedLogger","MUFICommentViewportTracking","Stratcom","pageID"],(function(a,b,c,d,e,f,g){"use strict";var h={},i=null;a=function(a){babelHelpers.inheritsLoose(b,a);b.trackStatically=function(a,d,e,f,g){var j=g+"_"+f,k=h[j];k||(k=new b(),h[j]=k,k.init({is_loose:!1,relaxed_min_size:!0,vpv_debug:!1,triggerOverride:[["scroll",null],["touchmove","ufi-overlay"]],vpvLoggingEnabled:d,timeTrackingEnabled:e,orderingMode:f,targetFBID:g}));i||(i=c("Stratcom").listen("m:page:unload",null,b.resetAll));k.addComments(a);k.fireEvent()};b.resetAll=function(){i&&i.remove(),i=null,h={}};function b(){var b;b=a.call(this)||this;b.resetTimeSpentInterval();b.comments=[];return b}var d=b.prototype;d.addComments=function(a){this.comments.push.apply(this.comments,a)};d.getDataFromConfig=function(b){a.prototype.getDataFromConfig.call(this,b),this.orderingMode=b.orderingMode,this.targetFBID=b.targetFBID};d.getAllStories=function(){return this.comments};d.recordVPVDurations=function(a,b){this.recordVPVDurationsInternal(a,b),(b||!a.length)&&(this.timeSpentIntervalStart<this.timeSpentIntervalEnd&&new(c("CommentsTimeSpentTypedLogger"))().setOrderingMode(this.orderingMode).setPostFbid(this.targetFBID).setStartTime(this.timeSpentIntervalStart).setEndTime(this.timeSpentIntervalEnd).setTimeSpentID(c("pageID")).log(),this.resetTimeSpentInterval())};d.sendTimetrackingDataToLog=function(a){var b=Math.round(a.vpvd_start_timestamp);b<this.timeSpentIntervalStart&&(this.timeSpentIntervalStart=b);b=b+Math.round(a.vpvd_time_delta/1e3);b>this.timeSpentIntervalEnd&&(this.timeSpentIntervalEnd=b)};d.resetTimeSpentInterval=function(){this.timeSpentIntervalStart=Number.MAX_VALUE,this.timeSpentIntervalEnd=0};return b}(c("MUFICommentViewportTracking"));g["default"]=a}),98);